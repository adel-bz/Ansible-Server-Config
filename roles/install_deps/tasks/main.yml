## Install dependencies role tasks ##

---

# 1. Install Certbot - Nginx - Docker and their dependencies #

- name: Install dependencies packages
  apt:
    update_cache: yes
    state: latest
    name:
    - apt-transport-https
    - ca-certificates
    - software-properties-common
    - python3-pip
    - docker.io
    - nginx
    - certbot
    - python3-certbot-nginx
  become: true

- name: Install Docker SDK for Python
  pip:
    name: docker

- name: Add user to Docker group
  user:
    name: "{{ user }}"
    groups: docker
    append: yes
  become: true

##################################################################

# 2. Install Docker Compose #

- name: Install Docker Compose
  shell: curl -L "https://github.com/docker/compose/releases/download/{{ docker_compose_version }}/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
  become: true

- name: Set permission for Docker Compose
  shell: chmod +x /usr/local/bin/docker-compose
  become: true

##################################################################
